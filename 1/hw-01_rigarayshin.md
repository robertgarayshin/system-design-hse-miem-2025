# [Room With A View](https://www.architecturalkatas.com/kata.html?kata=RoomWithAView.json)

A large hotel reservation company wants to build the next generation hotel reservation and management system specifically tailored to high-end resorts and spas where guests can view and reserve specific rooms.

**Users**: Guests (hundreds), hotel staff (less than 20)

**Requirements**:

* Registration can be made via `web`, `mobile`, `phone call`, or `walk-in`.

* Guests have the ability to either book a type of room (`standard`, `deluxe`, or `suite`) or choose a specific room to stay in by viewing pictures of each room and its location in the hotel.

* The system must be able to maintain room status (`booked`, `available`, `ready to clean`, etc.) as well as when the room will be needed next.

* It must also have state-of-the-art housekeeping management functionality so that cleaning and maintenance staff can be directed to various rooms based on priority and reservation need using proprietary devices supplied by the reservation company attached to the cleaning carts.

* Standard reservation functionality (e.g., `payments`, `registration info`, etc.) will be done by leveraging the existing reservations system.

* The system will be web-based and hosted by the reservation company.

**Additional Context**: 'Peak season is quickly approaching, so the system must be ready quickly or we have to wait until next year!'; Company is also investing heavily in cutting edge technology like smart room locks that open via a cell phone; Only interested in the high-end market; Sales people have tremendous clout in the organization; people often scramble to make their promises true

## 1. Отсев
**Если не реализовать систему**
* Исходя из дополнительного контекста к заданию, приближается "горячий" сезон, компания потеряет большое потенциальных клиентов с высоким уровнем дохода
* Компания имеет широкую сферу влияния, не реализованный заказ может сильно снизить уровень доверия к нам, как к исполнителям
* У компании уже есть существующая система резерваций `(will be done by leveraging the existing reservations system)`, поэтому процесс бронирования не остановится полностью, но компания потеряет средства, вложенные в системы контроля состояния комнат (уборки, ремонта и тд.)

**Метрики**
* Количество зарегистрированных пользователей в системе
* Количество отелей, подключенных к системе (исходя из условия, компания по бронированию отелей собирается подключать к системе не один, а несколько курортов, соответственно увеличение количества отелей, работающих с данной системой позволит значительно увеличить доходы компании)
* Количество забронированных номеров
* Количество положительных отзывов клиентов о процессе бронирования (или хотя бы отсутствие отрицательных)

**Приоритеты**
* **Обязательные**
  * Регистрация должна быть возможна из веб-сайта, мобильного приложения, с помощью контакт-центра и при личном присутствии   
  * Пользователь должен иметь возможность бронировать разные номера, узнавать их вид и локацию в отеле
  * Система должна иметь возможность управлять состояниями комнаты `забронирована`, `свободна`, `готова для уборки` и так далее.
  * Система должна иметь полную интеграцию со специальными устройствами для персонала отеля, чтобы сообщать о необходимости уборки/ремонта в номерах (устройства крепятся на тележках персонала)
  * Реализация системы должна быть осуществлена в кратчайшие сроки
* **Необязательные, но желательные**
  * Компания вкладывается в новые технологии, соответственно возможно использование ИИ для системы рекомендаций отелей исходя из предыдыущих выборов пользователя
  * Интеграция с умными дверными замками, в которые активно инвестирует заказчик (позволит сделать приложение all-in-one, пользователю не придется скачивать несколько приложений для получения всех доступных технологий отеля)

## 2. Scope Refinement
* **Пользователи**
  * Гости
  * Персонал отеля
  * (опционально) сотрудники контакт-центра, если потребуется наличие отдельного контакт-центра и не будет достаточно администратора в отеле
 
* Регистрация пользователя всеми возможными способами (веб, приложение, звонок, лично),
аутентификация пользователя и получение доступа к аккаунту,
просмотр доступных номеров, выбор номера по фото и локации в отеле,
выбор типа номера,
просмотр состояния номера (для гостей только `занят` и `свободен`, для персонала + `готов к уборке`, `необходим ремонт`, дату и время ближайшего заезда),
(для персонала) возможность отметить состояние номера,
оплата, бронирование и другие базовые функции из существующей системы,
размещение на серверах компании

## 3. Функциональные требования
* **Гости**
  * Регистрация и аутентификация гостя
  * Просмотр свободных номеров
  * Возможность бронирования свободных номеров на выбранную дату
  * Возможность оплаты номеров
  * Возможность работы с различных платформ
  * Удаление бронирования
  * Связь с отелем
  * Размещение заявок на починку и уборку
  * Просмотр графика уборки
* **Персонал**
  * То же, что и у гостей +
  * Ауентификация на корпоративный аккаунт
  * Изменение состояния номера
  * Обработка и закрытие заявок на ремонт/уборку
* **(опционально) работник КЦ**
  * Ауентификация как сотрудника КЦ
  * Обеспечение поддержки клиентов через звонки/чат
  * Регистрация новых пользователей
 
## 4, Нефункциональные требования
* **Производительность**
  * Задержка изменения статуса не более 1 секунды (критически важно в "высокий сезон")
  * Количество обрабатываемых запросов до 2 RPS
  * Время загрузки страницы с доступными номерами до 3 секунд
  * Характер нагрузки - высокая нагрузка в летний сезон, плавный спад к зиме, основная нагрузка в вечернее время

* **Масштабируемость**
  * Поддержка до 100 пользователей в системе одновременно (с возможностью масштабирования до 1000 пользователей)
  * Возможность горизонтального масштабирования и балансировки нагрузки на наиболее нагруженные системы
 
* **Отказоустойчивость**
  * SLA: 99.9% (большинство периодов недоступности в случае отсутствия критических сбоев должно приходиться на ночное время 02:00-03:00, а также на зимний период)
  * Высокая степень отказоустойчивости критических систем (просмотр номеров, бронирование, уборка)
 
* **Безопасность**
  * Данные пользователей должны храниться с соблюдением 152-ФЗ на территории РФ
  * Платежные данные пользователей должны храниться с обеспечением соответствия сертификату PCI-DSS.
 
* **Мониторинг**
  * Сбор критически важных метрик для системы с возможностью выгрузки отчетов
  * Алертинг в случае сбоя или повышения времени отклика
 
## 5.Ограничения
* Географические
  * Хранение и обработка данных согласно 152-ФЗ
  * Хранение и обработка платежных данных с сертификатом PCI-DSS
  * Учет географии часовых поясов в РФ и сопоставление периодов недоступности с основным потоком пользователей
* **Технологические**
  * Возможность внедрения рекомендательной системы
  * Обмен сообщениями в реальном врмемени (заявки, поддержка)
  * БД должна поддерживать возможность быстрого поиска, транзакционные операции
* Бизнес
  * Интеграция с умными устройствами от компании (умные замки, устройства для уборки)
  * Возможность оффлайн (личной) регистрации пользователей
  * Скорейшая реализация и внедрение системы
 
## 6. Расчет нагрузки
* **Входные данные**
  * Сотни гостей (предположительно): до 10000
  * Количество отелей (предположительно): 5
  * Персонал: 100 человек
  * Общий объем данных до 1 ТБ дискового хранилища
  * Основная нагрузка весной и летом
  * Малый вес входящих запросов и ответов для умных устройств
Нагрузка на систему не высокая, но при этом требует высокого уровня отказоустойчивости

## 7. Выводы
* Основные сложности - интеграция системы с умными устройствами от компании, требующих малый вес ответов от системы и отказоустойчивость критических узлов.  
* Требуется масштабируемая система с высоким уровнем отказоустойчивости (возможно необходима репликация) с возможностью увеличения нагрузки  
* База данных должна иметь возможность быстрого поиска по отелям.  
* Надежное хранение пользовательских данных с высоким уровнем безопасности и конфиденциальности
* Учет географичеких зон РФ для обеспечения периодов недоступности 
